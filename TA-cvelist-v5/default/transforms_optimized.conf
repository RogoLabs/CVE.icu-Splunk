# TA-cvelist-v5 transforms.conf
# OPTIMIZED - Index-time field extractions for blazing fast searches

#
# INDEX-TIME EXTRACTIONS (INDEXED = true)
#

# CVE ID - the primary identifier
[extract_cve_id_indexed]
REGEX = "cveId"\s*:\s*"(CVE-\d{4}-\d+)"
FORMAT = cve_id::$1
WRITE_META = true

# CVE State (PUBLISHED, REJECTED, etc)
[extract_cve_state_indexed]
REGEX = "state"\s*:\s*"([A-Z]+)"
FORMAT = cve_state::$1
WRITE_META = true

# Date Published and Date Updated
[extract_cve_dates_indexed]
REGEX = "datePublished"\s*:\s*"(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})[^"]*".*?"dateUpdated"\s*:\s*"(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})
FORMAT = date_published::$1 date_updated::$2
WRITE_META = true

# Assigner (CNA)
[extract_assigner_indexed]
REGEX = "assignerShortName"\s*:\s*"([^"]+)"
FORMAT = assigner::$1
WRITE_META = true

# CVSS Severity - try v4.0 first, then v3.1
[extract_cvss_severity_indexed]
REGEX = "baseSeverity"\s*:\s*"(CRITICAL|HIGH|MEDIUM|LOW|NONE)"
FORMAT = cvss_severity::$1
WRITE_META = true

# Affected Vendors (multi-value)
[extract_vendors_indexed]
REGEX = "vendor"\s*:\s*"([^"]+)"
FORMAT = vendor::$1
MV_ADD = true
WRITE_META = true

# CWE IDs (multi-value)
[extract_cwe_indexed]
REGEX = "cweId"\s*:\s*"(CWE-\d+)"
FORMAT = cwe_id::$1
MV_ADD = true
WRITE_META = true


#
# LOOKUPS
#
[cvss_severity_lookup]
filename = cvss_severity.csv
min_matches = 1
max_matches = 1
default_match = Unknown

[cwe_lookup]
filename = cwe_lookup.csv
min_matches = 1
max_matches = 1
default_match = Unknown
