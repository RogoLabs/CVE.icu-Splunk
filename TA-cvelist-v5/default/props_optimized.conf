# TA-cvelist-v5 props.conf
# OPTIMIZED for index-time field extraction

#
# CVE Record Sourcetype - INDEX TIME EXTRACTIONS
#
[ta:cvelist:v5:record]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
DATETIME_CONFIG = CURRENT
MAX_TIMESTAMP_LOOKAHEAD = 0
TZ = UTC
TRUNCATE = 0
KV_MODE = none

# INDEX-TIME field extractions (much faster than search-time)
TRANSFORMS-extract_cve_id = extract_cve_id_indexed
TRANSFORMS-extract_state = extract_cve_state_indexed
TRANSFORMS-extract_dates = extract_cve_dates_indexed
TRANSFORMS-extract_assigner = extract_assigner_indexed
TRANSFORMS-extract_severity = extract_cvss_severity_indexed
TRANSFORMS-extract_vendors = extract_vendors_indexed
TRANSFORMS-extract_cwe = extract_cwe_indexed

# Search-time calculated field for combined severity
EVAL-severity = coalesce(cvss_severity, "NONE")

#
# Error Sourcetype
#
[ta:cvelist:v5:error]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N%Z
TIME_PREFIX = "timestamp"\s*:\s*"
MAX_TIMESTAMP_LOOKAHEAD = 64
TZ = UTC
KV_MODE = json

#
# Audit Sourcetype
#
[ta:cvelist:v5:audit]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N%Z
TIME_PREFIX = "timestamp"\s*:\s*"
MAX_TIMESTAMP_LOOKAHEAD = 64
TZ = UTC
KV_MODE = json
