<dashboard version="1.1" theme="light" script="cveicu_theme.js">
    <label>CVE Dashboard</label>
    <description>Live CVE intelligence powered by cve.icu | Updated hourly from the official CVE Program</description>
    <fieldset submitButton="true" autoRun="true">
        <input type="dropdown" token="time_earliest" searchWhenChanged="true">
            <label>Time Range</label>
            <choice value="-7d@d">Last 7 days</choice>
            <choice value="-30d@d">Last 30 days</choice>
            <choice value="-90d@d">Last 90 days</choice>
            <choice value="-1y@d">Last 1 year</choice>
            <choice value="-5y@d">Last 5 years</choice>
            <choice value="0">All time</choice>
            <default>-1y@d</default>
        </input>
        <input type="dropdown" token="severity_filter" searchWhenChanged="true">
            <label>Severity</label>
            <choice value="*">All</choice>
            <choice value="CRITICAL">Critical</choice>
            <choice value="HIGH">High</choice>
            <choice value="MEDIUM">Medium</choice>
            <choice value="LOW">Low</choice>
            <default>*</default>
        </input>
    </fieldset>
    
    <row>
        <panel>
            <single>
                <title>Total CVEs Ingested</title>
                <search>
                    <query>| inputlookup cve_total.csv | table total_cves</query>
                    <earliest>0</earliest>
                    <latest>now</latest>
                </search>
                <option name="colorMode">block</option>
                <option name="drilldown">none</option>
                <option name="rangeColors">["0x53a051","0x006d9c"]</option>
                <option name="rangeValues">[0]</option>
                <option name="useColors">1</option>
                <option name="field">total_cves</option>
            </single>
        </panel>
        <panel>
            <single>
                <title>New CVEs (Selected Period)</title>
                <search>
                    <query>| inputlookup cve_daily_summary.csv
| eval date_epoch=strptime(date_published, "%Y-%m-%d")
| where date_epoch &gt;= relative_time(now(), "$time_earliest$")
| stats sum(cve_count) as new_cves</query>
                    <earliest>0</earliest>
                    <latest>now</latest>
                </search>
                <option name="colorMode">block</option>
                <option name="drilldown">none</option>
                <option name="rangeColors">["0x53a051","0xf8be34","0xdc4e41"]</option>
                <option name="rangeValues">[50,200]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <single>
                <title>Critical Severity</title>
                <search>
                    <query>| inputlookup cve_daily_summary.csv
| eval date_epoch=strptime(date_published, "%Y-%m-%d")
| where date_epoch &gt;= relative_time(now(), "$time_earliest$") AND severity="CRITICAL"
| stats sum(cve_count) as critical</query>
                    <earliest>0</earliest>
                    <latest>now</latest>
                </search>
                <option name="colorMode">block</option>
                <option name="drilldown">none</option>
                <option name="rangeColors">["0x53a051","0xf8be34","0xdc4e41"]</option>
                <option name="rangeValues">[5,20]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
        <panel>
            <single>
                <title>High Severity</title>
                <search>
                    <query>| inputlookup cve_daily_summary.csv
| eval date_epoch=strptime(date_published, "%Y-%m-%d")
| where date_epoch &gt;= relative_time(now(), "$time_earliest$") AND severity="HIGH"
| stats sum(cve_count) as high</query>
                    <earliest>0</earliest>
                    <latest>now</latest>
                </search>
                <option name="colorMode">block</option>
                <option name="drilldown">none</option>
                <option name="rangeColors">["0x53a051","0xf8be34","0xf1813f"]</option>
                <option name="rangeValues">[10,50]</option>
                <option name="useColors">1</option>
            </single>
        </panel>
    </row>
    <row>
        <panel>
            <chart>
                <title>CVE Publication Timeline</title>
                <search>
                    <query>| inputlookup cve_daily_summary.csv
| eval _time=strptime(date_published, "%Y-%m-%d")
| where _time &gt;= relative_time(now(), "$time_earliest$")
| timechart span=1d sum(cve_count) by severity</query>
                    <earliest>0</earliest>
                    <latest>now</latest>
                </search>
                <option name="charting.chart">column</option>
                <option name="charting.chart.stackMode">stacked</option>
                <option name="charting.legend.placement">bottom</option>
                <option name="charting.fieldColors">{"CRITICAL":"#DC4E41","HIGH":"#F1813F","MEDIUM":"#F8BE34","LOW":"#53A051","NONE":"#708794"}</option>
            </chart>
        </panel>
        <panel>
            <chart>
                <title>Severity Distribution</title>
                <search>
                    <query>| inputlookup cve_daily_summary.csv
| eval date_epoch=strptime(date_published, "%Y-%m-%d")
| where date_epoch &gt;= relative_time(now(), "$time_earliest$")
| stats sum(cve_count) as count by severity
| sort - count</query>
                    <earliest>0</earliest>
                    <latest>now</latest>
                </search>
                <option name="charting.chart">pie</option>
                <option name="charting.fieldColors">{"CRITICAL":"#DC4E41","HIGH":"#F1813F","MEDIUM":"#F8BE34","LOW":"#53A051","NONE":"#708794"}</option>
            </chart>
        </panel>
    </row>
    <row>
        <panel>
            <chart>
                <title>Top 10 Affected Vendors</title>
                <search>
                    <query>| inputlookup cve_vendors.csv
| sort - cve_count
| head 10
| table vendor cve_count</query>
                    <earliest>0</earliest>
                    <latest>now</latest>
                </search>
                <option name="charting.chart">bar</option>
                <option name="charting.legend.placement">none</option>
                <option name="charting.chart.showDataLabels">all</option>
                <option name="charting.axisTitleX.text">Vendor</option>
                <option name="charting.axisTitleY.text">CVE Count</option>
            </chart>
        </panel>
        <panel>
            <chart>
                <title>Top 10 Weakness Types (CWE)</title>
                <search>
                    <query>index=main sourcetype="ta:cvelist:v5:record"
| rex field=_raw "\"cweId\"\s*:\s*\"(?&lt;cwe_id&gt;CWE-\d+)\""
| rex field=_raw "\"state\"\s*:\s*\"(?&lt;cve_state&gt;PUBLISHED)\""
| rex field=_raw "\"datePublished\"\s*:\s*\"(?&lt;date_published&gt;\d{4}-\d{2}-\d{2})"
| eval date_epoch=strptime(date_published, "%Y-%m-%d")
| where cve_state="PUBLISHED" AND isnotnull(cwe_id) AND date_epoch &gt;= relative_time(now(), "$time_earliest$")
| stats count by cwe_id
| sort - count
| head 10
| lookup cwe_lookup.csv cwe_id OUTPUT cwe_name
| eval label=cwe_id
| table label count</query>
                    <earliest>0</earliest>
                    <latest>now</latest>
                </search>
                <option name="charting.chart">bar</option>
                <option name="charting.legend.placement">none</option>
                <option name="charting.chart.showDataLabels">all</option>
            </chart>
        </panel>
    </row>
    <row>
        <panel>
            <table>
                <title>Recent CVEs</title>
                <search>
                    <query>index=main sourcetype="ta:cvelist:v5:record"
| rex field=_raw "\"cveId\"\s*:\s*\"(?&lt;cve_id&gt;CVE-\d{4}-\d+)\""
| rex field=_raw "\"state\"\s*:\s*\"(?&lt;cve_state&gt;PUBLISHED)\""
| rex field=_raw "\"datePublished\"\s*:\s*\"(?&lt;date_published&gt;[^\"]+)\""
| rex field=_raw "\"baseSeverity\"\s*:\s*\"(?&lt;severity&gt;[^\"]+)\""
| rex field=_raw "\"baseScore\"\s*:\s*(?&lt;cvss_score&gt;[\d.]+)"
| rex field=_raw "\"vendor\"\s*:\s*\"(?&lt;vendor&gt;[^\"]+)\""
| rex field=_raw "\"product\"\s*:\s*\"(?&lt;product&gt;[^\"]+)\""
| rex field=_raw "\"value\"\s*:\s*\"(?&lt;description&gt;[^\"]{1,200})"
| where cve_state="PUBLISHED"
| eval date_published=substr(date_published,1,10)
| eval severity=if(isnull(severity),"NONE",severity)
| eval cvss_score=if(isnull(cvss_score),"-",cvss_score)
| sort - date_published
| dedup cve_id
| head 20
| table date_published cve_id severity cvss_score vendor product description</query>
                    <earliest>$time_earliest$</earliest>
                    <latest>now</latest>
                </search>
                <option name="drilldown">cell</option>
                <option name="count">10</option>
                <drilldown>
                    <link target="_blank">https://www.cve.org/CVERecord?id=$row.cve_id$</link>
                </drilldown>
            </table>
        </panel>
    </row>
</dashboard>
