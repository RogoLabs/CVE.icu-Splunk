# TA-cveicu transforms.conf
# Field transformations and lookups for CVE V5 records

#
# CVSS Severity to Category Lookup
#
[cvss_severity_lookup]
filename = cvss_severity.csv
min_matches = 1
max_matches = 1
default_match = Unknown

#
# CWE Description Lookup (optional external enrichment)
#
[cwe_lookup]
filename = cwe_lookup.csv
min_matches = 1
max_matches = 1
default_match = Unknown

#
# EPSS Score Lookup - Exploit Prediction Scoring System
# Provides probability (0-1) of exploitation in next 30 days
#
[epss_lookup]
filename = epss_lookup.csv
match_type = CASE(true)
min_matches = 1
max_matches = 1
default_match = 0

#
# CISA KEV Lookup - Known Exploited Vulnerabilities
# Maps CVE IDs to CISA KEV catalog data
#
[kev_lookup]
filename = kev_lookup.csv
match_type = CASE(true)
min_matches = 1
max_matches = 1

#
# Risk Priority Lookup - Combined risk scoring
# Merges CVSS, EPSS, and KEV for prioritization
#
[risk_priority_lookup]
filename = risk_priority_lookup.csv
match_type = CASE(true)
min_matches = 1
max_matches = 1

#
# Extract multi-value CWE IDs
#
[extract_cwe_ids]
SOURCE_KEY = _raw
REGEX = "cweId"\s*:\s*"(CWE-\d+)"
FORMAT = cwe_id::$1
MV_ADD = true

#
# Extract multi-value affected vendors
#
[extract_vendors]
SOURCE_KEY = _raw
REGEX = "vendor"\s*:\s*"([^"]+)"
FORMAT = affected_vendor::$1
MV_ADD = true

#
# Extract multi-value affected products
#
[extract_products]
SOURCE_KEY = _raw
REGEX = "product"\s*:\s*"([^"]+)"
FORMAT = affected_product::$1
MV_ADD = true

#
# Extract reference URLs
#
[extract_references]
SOURCE_KEY = _raw
REGEX = "references"[^\]]*"url"\s*:\s*"([^"]+)"
FORMAT = reference_url::$1
MV_ADD = true

#
# CVSS v3.1 score extraction
#
[extract_cvss_v31]
SOURCE_KEY = _raw
REGEX = "cvssV3_1"[^}]*"baseScore"\s*:\s*([\d.]+)[^}]*"baseSeverity"\s*:\s*"([^"]+)"
FORMAT = cvss_v31_score::$1 cvss_v31_severity::$2

#
# CVSS v4.0 score extraction
#
[extract_cvss_v40]
SOURCE_KEY = _raw
REGEX = "cvssV4_0"[^}]*"baseScore"\s*:\s*([\d.]+)[^}]*"baseSeverity"\s*:\s*"([^"]+)"
FORMAT = cvss_v40_score::$1 cvss_v40_severity::$2

#
# SSVC Exploitation Status extraction
#
[extract_ssvc_exploitation]
SOURCE_KEY = _raw
REGEX = "Exploitation"\s*:\s*"([^"]+)"
FORMAT = ssvc_exploitation::$1

#
# SSVC Automatable extraction
#
[extract_ssvc_automatable]
SOURCE_KEY = _raw
REGEX = "Automatable"\s*:\s*"([^"]+)"
FORMAT = ssvc_automatable::$1

#
# SSVC Technical Impact extraction
#
[extract_ssvc_technical_impact]
SOURCE_KEY = _raw
REGEX = "Technical Impact"\s*:\s*"([^"]+)"
FORMAT = ssvc_technical_impact::$1

#
# Pre-computed Dashboard Lookups
#
[cve_total]
filename = cve_total.csv

[cve_daily_summary]
filename = cve_daily_summary.csv

[cve_vendors]
filename = cve_vendors.csv
